<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>IMGLIB: IMG_thr_le2thr_8</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<table width=100%>
<tr>
  <td bgcolor="black" width="1"><a href="http://www.ti.com"><img border=0 src="tilogo.gif"></a></td>
  <td bgcolor="red"><img src="titagline.gif"></td>
</tr>
</table>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<h1>IMG_thr_le2thr_8</h1><hr><a name="_details"></a><h2>Detailed Description</h2>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___i_m_g__thr__le2thr__8.html#gaf8ca89c2d48226a3818715881267f20">IMG_thr_le2thr_8</a> (const unsigned char *in_data, unsigned char *restrict out_data, short cols, short rows, unsigned char threshold)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="gaf8ca89c2d48226a3818715881267f20"></a><!-- doxytag: member="c66/IMG_thr_le2thr_8.h::IMG_thr_le2thr_8" ref="gaf8ca89c2d48226a3818715881267f20" args="(const unsigned char *in_data, unsigned char *restrict out_data, short cols, short rows, unsigned char threshold)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IMG_thr_le2thr_8           </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&nbsp;</td>
          <td class="paramname"> <em>in_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *restrict&nbsp;</td>
          <td class="paramname"> <em>out_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&nbsp;</td>
          <td class="paramname"> <em>cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&nbsp;</td>
          <td class="paramname"> <em>rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>threshold</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl class="user" compact><dt><b>Description:</b></dt><dd>This kernel performs a thresholding operation on the input image "in_data" with dimensions as specified by the input arguments "cols" and "rows". The thresholded pixels are written to the output image pointed to by "out_data". The input and output images are of the same dimensions. </dd></dl>
<dl class="user" compact><dt><b></b></dt><dd>Pixels that are equal to or above the threshold value are written to the output unmodified. Pixels that are less than the threshold are set to the threshold value in the output image. </dd></dl>
<dl class="user" compact><dt><b></b></dt><dd></dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>in_data</em>&nbsp;</td><td>Input image pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>out_data</em>&nbsp;</td><td>Output image pointer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cols</em>&nbsp;</td><td>Number of columns in the image </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rows</em>&nbsp;</td><td>Number of rows in the image </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>threshold</em>&nbsp;</td><td>The (unsigned 8-bit) threshold</td></tr>
  </table>
</dl>
<dl class="user" compact><dt><b>Algorithm:</b></dt><dd>The thresholding function is illustrated in the transfer function diagram below: <div class="fragment"><pre class="fragment">
                                                                      
               255_|                                                  
                   |                  /                               
                   |                /                                 
          O        |              /                                   
          U        |            /                                     
          T    th _|_________ /                                       
          P        |         .                                        
          U        |         .                                        
          T        |         .                                        
                   |         .                                        
                 0_|_________.__________                              
                   |         |        |                               
                   0        th       255                              
                                                                      
                           INPUT                                      
   </pre></div></dd></dl>
<dl class="user" compact><dt><b></b></dt><dd>The main thresholding loop is manually unrolled four times. The compiler is instructed to unroll by an additional factor of four, yielding a total unroll factor of 16. </dd></dl>
<dl class="user" compact><dt><b></b></dt><dd>A packed-data processing techniques is used to allow the processing of four pixels in parallel. The _amem4_const() intrinsic brings in four pixels, designated p0 thru p3. These pixels are packed into an unsigned integer variable p3p2p1p0 as illustrated below: <div class="fragment"><pre class="fragment">
                                                                     
                         31  24   16    8    0                        
                         +----+----+----+----+                       
                p3p2p1p0 | p3 | p2 | p1 | p0 |                       
                         +----+----+----+----+                       
   </pre></div> </dd></dl>
<dl class="user" compact><dt><b></b></dt><dd>(Note that this illustration assumes a little endian memory configuration). We compare this packed word to a (4x) packed copy of the threshold. The packed threshold contains four copies of the threshold value, one per byte: <div class="fragment"><pre class="fragment">
                                                                   
                       31  24   16    8    0                       
                         +----+----+----+----+                      
                thththth | th | th | th | th |                      
                         +----+----+----+----+
   </pre></div> </dd></dl>
<dl class="user" compact><dt><b></b></dt><dd>We compare using the intrinsic _maxu4(). This instruction will select the larger value between the input pixels and the threshold value. The result is that input values below the threshold are clamped to the threshold value. The four pixels are then written with a single _amem4(). </dd></dl>
<dl class="user" compact><dt><b></b></dt><dd>In this version of the code, we rely on the compiler to unroll the loop 4x (as noted above), and convert the _amem4_const() and _amem4() calls into _amemd8_const()/_amemd8() as part of its automatic optimizations. </dd></dl>
<dl class="user" compact><dt><b></b></dt><dd>The natural C implementation has no restrictions. The optimized intrinsic C code has restrictions as noted in Assumptions below.</dd></dl>
<dl class="user" compact><dt><b>Assumptions:</b></dt><dd><ul>
<li>The input array and output array should not overlap</li><li>Both input and output arrays must be 64-bit aligned</li><li>The number of image pixels (cols x rows) must be a multiple of 16</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Implementation Notes:</b></dt><dd><ul>
<li>This code is fully interruptible</li><li>This code is compatible with C66x processors</li><li>This code is endian neutral</li></ul>
</dd></dl>
<dl class="user" compact><dt><b>Benchmarks:</b></dt><dd>See IMGLIB_Test_Report.html for cycle and memory information. </dd></dl>

</div>
</div><p>
<hr size="1"><small>
Copyright  2012, Texas Instruments Incorporated</small>
</body>
</html>
